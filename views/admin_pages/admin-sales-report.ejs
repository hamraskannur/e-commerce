<%- include( '../includes/admin_includes/admin_head.ejs' ) %>


<body class="g-sidenav-show  bg-gray-200">
  <aside class="sidenav navbar navbar-vertical navbar-expand-xs border-0 border-radius-xl my-3 fixed-start ms-3   bg-gradient-dark" id="sidenav-main">
    <div class="sidenav-header">
      <i class="fas fa-times p-3 cursor-pointer text-white opacity-5 position-absolute end-0 top-0 d-none d-xl-none" aria-hidden="true" id="iconSidenav"></i>
      <a class="navbar-brand m-0" href="/admin/admin_home" target="_blank">
        <img src="/admin/img/logo-ct.png" class="navbar-brand-img h-100" alt="main_logo">
        <span class="ms-1 font-weight-bold text-white">Material Dashboard 2</span>
      </a>
    </div>
    <hr class="horizontal light mt-0 mb-2">
    <div class="collapse navbar-collapse  w-auto  max-height-vh-100" id="sidenav-collapse-main">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link text-white " href="/admin/admin_home">
            <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
              <i class="material-icons opacity-10">dashboard</i>
            </div>
            <span class="nav-link-text ms-1">Dashboard</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white " href="/admin/admin_userlist">
            <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
                <i class="bi bi-person"></i>            </div>
            <span class="nav-link-text ms-1">Userlist</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white " href="/admin/admin_productlist">
            <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
              <i class="fab fa-product-hunt opacity-10"></i>
            </div>
            <span class="nav-link-text ms-1">Products</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white " href="/admin/admin_Categorylist">
            <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
              <i class="fab fa-product-hunt opacity-10"></i>
            </div>
            <span class="nav-link-text ms-1">Category</span>
          </a>
        </li>
       
        <li class="nav-item">
          <a class="nav-link text-white " href="/admin/admin-oderslis">
            <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
              <i class="material-icons opacity-10">receipt_long</i>
            </div>
            <span class="nav-link-text ms-1">Orders</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white active bg-gradient-primary" href="/admin/SalesReport">
            <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
              <i class="material-icons opacity-10">view_in_ar</i>
            </div>
            <span class="nav-link-text ms-1">Sales Report</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white " href="/admin/getCouponPage">
            <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
              <i class="material-icons opacity-10">format_textdirection_r_to_l</i>
            </div>
            <span class="nav-link-text ms-1">Coupon</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white " href="/admin/Messages">
            <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
                <i class="bi bi-envelope"></i>
            </div>
            <span class="nav-link-text ms-1">Message</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white " href="/admin/getBanners">
            <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
                <i class="fas fa-align-left"></i>            </div>
            <span class="nav-link-text ms-1">Banners</span>
          </a>
        </li>
       
        <li class="nav-item">
          <a class="nav-link text-white " href="/admin/adminlogout">
            <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
              <i class="material-icons opacity-10">login</i>
            </div>
            <span class="nav-link-text ms-1">Logout</span>
          </a>
        </li>
     
      </ul>
    </div>
    <div class="sidenav-footer position-absolute w-100 bottom-0 ">
      <div class="mx-3">
        <a class="btn bg-gradient-primary mt-4 w-100" href="https://www.creative-tim.com/product/material-dashboard-pro?ref=sidebarfree" type="button">Upgrade to pro</a>
      </div>
    </div>
  </aside>
  <main class="main-content position-relative max-height-vh-100 h-100 border-radius-lg ">
    <!-- Navbar -->
   
          <div class="ms-md-auto pe-md-3 d-flex align-items-center">
            <div class="input-group input-group-outline">
              <label class="form-label">Type here...</label>
              <input type="text" class="form-control">
            </div>
          </div>


>








            <div class="align-items-center justify-content-center">

                <div style="margin-left: 5rem; width: 100rem; " class="row mb-4 mt-5 ml-5">
                    <div class="col-lg-8 col-md-6 mb-md-0 mb-4 mt-5 ml-5">
                        <div class="card">
                            <div class="card-header pb-0">
                                <div class="row">
                                    <div class="col-lg-6 col-7">
                                        <h6>Sales Report</h6>
                                        <p class="text-sm mb-0">
                                            <i class="fa fa-check text-info" aria-hidden="true"></i>
                                            <span class="font-weight-bold ms-1">Last 30 days sales Report</span>
                                        </p>
                                    </div>
                                    <div class="col-lg-6 col-5 my-auto text-end">
                                        <div class="dropdown float-lg-end pe-4">
                                            <a class="cursor-pointer" id="dropdownTable" data-bs-toggle="dropdown"
                                                aria-expanded="false">
                                                <i class="fa fa-ellipsis-v text-secondary"></i>
                                            </a>
                                            <ul class="dropdown-menu px-2 py-3 ms-sm-n4 ms-n5"
                                                aria-labelledby="dropdownTable">
                                                <li><a class="dropdown-item border-radius-md"
                                                    onclick="printDiv('table','sales Report')"   href="javascript:;">download</a></li>
                                                <li><a class="dropdown-item border-radius-md"
                                                        href="javascript:;">Another action</a></li>
                                                <li><a class="dropdown-item border-radius-md"
                                                        href="javascript:;">Something else here</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div  id="table" class="card-body px-0 pb-2 ">
                                <div class="table-responsive">
                                    <table class="table align-items-center mb-0">
                                        <thead>
                                            <tr>
                                                <th
                                                    class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">
                                                    Date</th>
                                                <th
                                                    class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">
                                                    Totalprice</th>
                                                <th
                                                    class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">
                                                    profit </th>
                                                <th
                                                    class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">
                                                    orderCount</th>
                                                <th
                                                    class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">
                                                    Completion</th>
                                            </tr>
                                        </thead>
                                       

                                                <tbody>
                                                    <tr>
                                                        <% if( salesReport.length> 0 ) { %>
                                                            <% for( i=0;i< salesReport.length ; i++ ) { %>
                                                        <td>
                                                            <div class="d-flex px-2 py-1">

                                                                <div class="d-flex flex-column justify-content-center">
                                                                    <h6 class="mb-0 text-sm">
                                                                        <%=salesReport[i]._id%>
                                                                    </h6>
                                                                </div>
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <div class="d-flex px-2 py-1">

                                                                <div class="d-flex flex-column justify-content-center">
                                                                    <h6 class="mb-0 text-sm">
                                                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-currency-rupee" viewBox="0 0 16 16">
                                                                            <path d="M4 3.06h2.726c1.22 0 2.12.575 2.325 1.724H4v1.051h5.051C8.855 7.001 8 7.558 6.788 7.558H4v1.317L8.437 14h2.11L6.095 8.884h.855c2.316-.018 3.465-1.476 3.688-3.049H12V4.784h-1.345c-.08-.778-.357-1.335-.793-1.732H12V2H4v1.06Z"/>
                                                                          </svg><%=salesReport[i].totalprice%>
                                                                    </h6>
                                                                </div>
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <div class="d-flex px-2 py-1">

                                                                <div class="d-flex flex-column justify-content-center">
                                                                    <h6 class="mb-0 text-sm">
                                                                       <%= parseInt((salesReport[i].totalprice*2)/100)%>
                                                                    </h6>
                                                                </div>
                                                            </div>
                                                        </td>
                                                        <td class="align-middle text-center text-sm">
                                                            <% for( j=i;j < salesReporttotal.length ; j++ ) { %>
                                                            <span class="text-xs font-weight-bold">
                                                                <%=salesReporttotal[j].orderCount%>
                                                            </span>
                                                         <% break %> 
                                                            <% }%>
                                                        </td>
                                                        <td class="align-middle">
                                                            <div class="progress-wrapper w-75 mx-auto">
                                                                <div class="progress-info">
                                                                    <div class="progress-percentage">
                                                                        <span class="text-xs font-weight-bold">
                                                                            <%= parseInt((salesReport[i].totalprice*2)/10000/2)%>%
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                              <script>
                                                              
                                                                </script>
                                                                <div class="progress">                                                                                                                            
                                                                    <div class="progress-bar progress-bar-striped bg-danger"  role="progressbar"
                                                                         style="width: <%=parseInt((salesReport[i].totalprice*20)/100000/2)%>% " aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
                                                                  </div>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <% } %>
                                                <% } else { %>
                                                    <div>
                                                        <h1>comeing soon product</h1>
                                                    </div>
                                                    <% }%>
                                                        <tr>
                                                          
                                                            <td>
                                                                <div class="d-flex px-2 py-1">

                                                                    <div class="d-flex flex-column justify-content-center">
                                                                        <h6 class="mb-0 text-sm">Total :</h6>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                            <td>
                                                                <div class="d-flex px-2 py-1">
                                                                    <div
                                                                        class="d-flex flex-column justify-content-center">
                                                                        <h6 class="mb-0 text-sm">
                                                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-currency-rupee" viewBox="0 0 16 16">
                                                                            <path d="M4 3.06h2.726c1.22 0 2.12.575 2.325 1.724H4v1.051h5.051C8.855 7.001 8 7.558 6.788 7.558H4v1.317L8.437 14h2.11L6.095 8.884h.855c2.316-.018 3.465-1.476 3.688-3.049H12V4.784h-1.345c-.08-.778-.357-1.335-.793-1.732H12V2H4v1.06Z"/>
                                                                          </svg><%=totalprice[0].totalprice%></h6>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                         
                                                        </tr>
                                                  </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            </div>
        </main>
        
        
     
        
<script>
var doc = new jsPDF();
 function saveDiv(divId, title) {
 doc.fromHTML(`<html><head><title>${title}</title></head><body>` + document.getElementById(divId).innerHTML + `</body></html>`);
 doc.save('div.pdf');
}

function printDiv(divId,title) {
  let mywindow = window.open('', 'PRINT', 'height=650,width=900,top=100,left=150');
  mywindow.document.write(`<html><head><title>${title}</title>`);
  mywindow.document.write('</head><body >');
  mywindow.document.write(document.getElementById(divId).innerHTML);
  mywindow.document.write('</body></html>');

  mywindow.document.close(); // necessary for IE >= 10
  mywindow.focus(); // necessary for IE >= 10*/

  mywindow.print();
  mywindow.close();

  return true;
}
</script>


<%- include( '../includes/admin_includes/admin_end.ejs' ) %>
